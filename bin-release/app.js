!function(){"use strict";function e(){let e={},t=e.hasOwnProperty;return{subscribe:function(n,i){t.call(e,n)||(e[n]=[]);let a=e[n].push(i)-1;return{remove:function(){delete e[n][a]}}},publish:function(n,i){t.call(e,n)&&e[n].forEach(function(e){e(void 0!=i?i:{})})}}}function t(e,t,n,i){function a(e){try{xe.broadcast(JSON.stringify(e))}catch(e){console.warn("Unable to broadcast message: %O",e)}}function s(e,t){try{xe.send(e,JSON.stringify(t))}catch(e){console.warn("Unable to send message: %O",e)}}function r(e){if(e.data){let t;try{t=JSON.parse(e.data)}catch(t){return void console.warn("Unable to parse event: %O",e)}if(!t.type)return void ge(i,F.INVALID_COMMAND);let i={senderId:e.senderId,data:t,type:t.type};switch(i.type!=v.GET_STATUS&&n.publish(O,{reason:i.type}),i.type){case v.LOAD:return void o(i);case v.QUEUE_LOAD:return void w(i);case v.GET_STATUS:return void l(i)}if(!Fe)return void Se(i);if(i.data.mediaSessionId==Fe.mediaSessionId)switch(i.data.requestId&&(Be=i.data.requestId),i.type){case v.STOP:c(i);break;case v.PAUSE:u(i);break;case v.PLAY:d(i);break;case v.SEEK:m(i);break;case v.SET_VOLUME:f(i);break;case v.EDIT_TRACKS_INFO:E(i);break;case v.QUEUE_INSERT:z(i);break;case v.QUEUE_UPDATE:J(i);break;case v.QUEUE_REMOVE:$(i);break;case v.QUEUE_REORDER:Z(i);break;case v.PRELOAD:ee(i);break;case v.CANCEL_PRELOAD:te(i);break;default:De(M.INVALID_REQUEST,F.INVALID_COMMAND,i),console.warn("Received invalid command "+i.type)}}}function o(e){Ve&&_e(e),Ne(),fe(e.data).then(()=>{Ve=!1,he(e.senderId,e.data.requestId)},t=>{Be=e.data.requestId,ie(t)}),n.publish(_,{items:[e.data]})}function c(e){Me?(Me.stop(),Fe.idleReason=B.CANCELLED,Ae()):Se(e)}function u(e){Me?(Me.pause(!0),Fe.breakStatus&&(Fe.playerState=P.PAUSED,Ae())):Se(e)}function d(e){Me?(Me.play(!0),Fe.breakStatus&&(Fe.playerState=P.PLAYING,Ae())):Se(e)}function m(e){Me&&e.data.mediaSessionId==Fe.mediaSessionId?(e.data.currentTime>=0&&(Me.once("seeked",()=>{Ae(e.data.requestId)}),Me.seek(e.data.currentTime)),e.data.resumeState&&Me.play(e.data.resumeState==x.PLAYBACK_START)):Se(e)}function f(e){Me?(Fe.volume={level:e.data.level,mute:e.data.mute},Me.setVolume(100*e.data.level),Me.setMute(e.data.mute),Ae()):Se(e)}function l(e){he(e.senderId,e.data.requestId)}function E(e){e.data.textTrackStyle;let t=e.data.activeTrackIds;if(t){let e=!0;t.forEach(t=>{let n=be(t);if(n)if(n.type==V.TEXT){let t=Me.getCaptionsList();t.some((t,i)=>{if(t.id==n.trackContentId)return e=!1,Me.getCurrentCaptions()!=i&&Me.setCurrentCaptions(i),!0})}else n.type==V.AUDIO?Me.setCurrentAudioTrack(n.trackContentId):n.type==V.VIDEO}),e&&Me.setCurrentCaptions(X)}Ae()}function w(e){Ve&&_e(e),Ne(),e.data.items.forEach((e,t)=>{e.itemId=++t}),Fe.items=e.data.items,Fe.repeatMode=e.data.repeatMode;let t=Fe.items[e.data.startIndex];fe(t).then(()=>{Ve=!1,he(e.senderId,e.data.requestId)},t=>{Be=e.data.requestId,ie(t)}),n.publish(_,{items:Fe.items,repeatMode:Fe.repeatMode})}function z(e){let t=1;if(Fe.items.forEach(e=>{e.itemId>=t&&(t=e.itemId+1)}),e.data.items.forEach(e=>{e.itemId=t++}),e.data.insertBefore){let t=Le(e.data.insertBefore);Array.prototype.splice.apply(Fe.items,[t,0].concat(e.data.items))}else Fe.items=Fe.items.concat(e.data.items);let i;void 0!==e.data.currentItemIndex?i=Fe.items[e.data.currentItemIndex]:e.data.currentItem&&e.data.currentItem!=Fe.currentItem&&(i=Fe.items[Le(e.data.currentItem)]),i?(i.startTimeOverride=e.data.currentTime,fe(i).catch(ie)):Ae(),n.publish(D,{items:Fe.items})}function J(e){if(e.data.currentItemId){let t=Fe.items[Le(e.data.currentItemId)];t.startTimeOverride=e.data.currentTime,fe(t).catch(ie)}else if(e.data.jump){let t=ke()+e.data.jump;t>=Fe.items.length&&(t-=Fe.items.length),t<0&&(t+=Fe.items.length);let n=Fe.items[ke()+e.data.jump];n.startTimeOverride=e.data.currentTime,fe(n).catch(ie)}e.data.repeatMode&&(Fe.repeatMode=e.data.repeatMode)}function $(e){if(!e.data.itemIds||0==e.data.itemIds.length)return void ge(e,F.INVALID_COMMAND);if(0==Fe.items.length)return void Se(e);if(e.data.itemIds.forEach(e=>{let t=Le(e);Fe.items.splice(t,1)}),e.data.currentItemId&&e.data.currentItemId!=Fe.currentItemId){let t=Fe.items[Le(e.data.currentItemId)];t.startTimeOverride=e.data.currentTime,fe(t).catch(ie)}else ke()===-1?Me&&Me.stop():Ae()}function Z(e){let t=e.data.itemIds;if(!t)return void ge(e,F.INVALID_COMMAND);if(e.data.insertBefore){let n=Le(e.data.insertBefore);if(!n)return void ge(e,F.INVALID_COMMAND);for(let i=n;t.length>0;i++){let e=Fe.items.splice(Le(t.shift()),1)[0];Fe.items.splice(i-1,0,e)}}else for(;t.length;){let e=Fe.items.splice(Le(t.shift()),1)[0];Fe.items.push(e)}Ae()}function ee(e){De(M.INVALID_REQUEST,F.INVALID_COMMAND,e)}function te(e){De(M.INVALID_REQUEST,F.INVALID_COMMAND,e)}function ne(){n.publish(S,{item:Fe.media}),le()}function ie(e){console.error("Failed to initialize player: %O",e),a({type:M.LOAD_FAILED,requestId:Be?Be:0}),Be=0,Fe.playerState=P.IDLE,Fe.idleReason=B.ERROR,Ae()}function ae(e){let t=ve(),i=t||Fe.repeatMode==R.REPEAT_ALL_AND_SHUFFLE&&Fe.items&&Fe.items.length>2;n.publish(U,{error:e,currentItem:Fe.media,nextItem:t,willAdvance:i,timeout:W}),(t||i)&&window.setTimeout(()=>{le()},W)}function se(e){if(n.publish(g,{currentTime:e.position,duration:e.duration}),Fe){Fe.currentTime=e.position;let t=!1;if(Fe.media.duration!=e.duration){t=!0;let n=Fe.media;if(n.duration=e.duration,n.customData&&n.customData.advertising&&n.customData.advertising.schedule){let e=Fe.media.breaks||[],t=n.customData.advertising.schedule;Object.keys(t).forEach(i=>{let a=t[i];if(a.offset.indexOf("%")===-1||"post"===a.offset){let t="post"===a.offset?n.duration:Oe(a.offset,n.duration);e.push(new G(i,t))}}),Fe.media.breaks=e}}t&&Ae()}}function re(e){let t=!1;Fe.media.tracks=Fe.media.tracks||[],e.tracks.forEach((e,n)=>{if(0!=n){let n=0==Fe.media.tracks.length||!Fe.media.tracks.some(t=>t.type==V.TEXT&&t.trackContentId==e.id);n&&(Fe.media.tracks.push({name:e.label,trackContentId:e.id,trackId:Re(),type:V.TEXT,subtype:j.CAPTIONS}),t=!0)}}),0!=e.track||t||(t=we()),t&&Ae()}function oe(e){let t=!1;Fe.media.tracks=Fe.media.tracks||[],e.tracks.forEach((e,n)=>{let i=0==Fe.media.tracks.length||!Fe.media.tracks.some(e=>e.type==V.AUDIO&&e.trackContentId==n);i&&(Fe.media.tracks.push({name:e.name,trackContentId:n,type:V.AUDIO,trackId:Re()}),t=!0)}),t&&(we(),Ae())}function ce(e){let t=e.ima;if(t){let n=new Y;Object.keys(n).forEach(t=>{void 0!==e[t]&&(n[t]=e[t])}),n.title=e.adtitle;let i=t.ad;Object.keys(i).some(e=>{if(void 0!==i[e].clickThroughUrl)return n.clickthrough=i[e].clickThroughUrl,!0});let a=i.getAdPodInfo();a&&(n.sequence=a.getAdPosition(),n.podcount=a.getTotalAds());let s=new google.ima.CompanionAdSelectionSettings;s.sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE,n.companions=H.convertImaCompanions(i.getCompanionAds(300,250,s)),ue(n)}}function ue(e){n.publish(N,{meta:e});let t=Fe.customData;t.adMeta=e,Fe.playerState=P.PLAYING,e.sequence&&1!=e.sequence||(je=Date.now());let i=Me.getPlaylist()[Me.getPlaylistIndex()].adschedule;if(i){let t=Fe.media.breaks;if(!t){t=[];let e=Fe.media.customData.advertising.schedule;Object.keys(e).forEach(n=>{let i=e[n];if(i.offset.indexOf("%")==-1&&"post"!==i.offset){let e;e="pre"==i.offset?0:i.offset.indexOf(":")!=-1?jwplayer.utils.seconds(i.offset):Number.parseFloat(i.offset),t.push(new G(n,e)),Fe.media.breaks=t}})}let n=Fe.media.breakClips||[],a=null;Object.keys(i).some(t=>{if(i[t].tag==e.tag)return a=t,!0});let s=null;t.some(e=>{if(e.id==a)return s=e,!0});let r=new Q(e.id);r.clickThroughUrl=e.clickthrough,r.title=e.title,r.mimeType=e.creativetype,n.push(r),Fe.media.breakClips=n;let o=s.breakClipIds||[];o.push(r.id),s.breakClipIds=o;let c=new q(0,0);c.breakId=a,c.breakClipId=r.id,c.whenSkippable=e.skipoffset?e.skipoffset:-1,Fe.breakStatus=c}Ae()}function de(e){if(n.publish(y,e),Fe.breakStatus){let t=Fe.breakStatus;t.currentBreakClipTime=e.position,t.currentBreakTime=(Date.now()-je)/1e3,Fe.media.breakClips.some(n=>{if(n.id===t.breakClipId)return n.duration=e.duration,!0})}}function me(e){n.publish(b,e);let t=Fe.customData;delete t.adMeta,Fe.media.breaks.some(t=>{if(t.breakClipIds&&t.breakClipIds.indexOf(e.id)!=-1)return t.isWatched=!0,!0}),delete Fe.breakStatus,Ae()}function fe(e){return new Promise((a,s)=>{n.publish(I,{item:e}),Me||(Me=jwplayer(t));let r=e.media?e.media:e,o=Ce(r),c={primary:"html5",width:"100%",height:"100%",playlist:o,hlshtml:!0,autostart:!e.autoplay||e.autoplay,controls:!1,analytics:i},u=r.customData||{};if(u.advertising&&u.advertising.client&&(c.advertising={client:u.advertising.client}),u.drm&&(c.drm=u.drm),Me.setup(c),Fe.currentTime=0,(e.startTimeOverride||e.startTime)&&"LIVE"!=e.streamType){let t=e.startTimeOverride?e.startTimeOverride:e.startTime;Fe.currentTime=t,Me.once("ready",function(){Me.seek(t)}),delete e.startTimeOverride}Fe.playerState=e.autoplay||void 0===e.autoplay?P.BUFFERING:P.PAUSED,Fe.media=r,Fe.activeTrackIds=[],Fe.media.duration=Fe.media.duration||0,e.itemId?Fe.currentItemId=e.itemId:delete Fe.currentItemId,pe(),Me.once("setupError",s),Me.once("error",s),Fe.media.duration&&Pe(r);let d=Fe.media.breaks&&Fe.media.breaks.some(e=>{return 0===e.position});if(d&&!Fe.media.duration)a();else{const e=t=>{console.log("onDuration"),t.duration>=0&&(Me.off("meta time",e),Fe.media.duration=t.duration,a())};Me.on("meta time",e)}})}function le(){let e,t,n,i;if(Fe)switch(Fe.repeatMode){case R.REPEAT_OFF:Fe.items&&(Fe.items.shift(),0!=Fe.items.length?fe(Fe.items[0]).catch(ie):Fe.idleReason=B.FINISHED);break;case R.REPEAT_ALL:e=ke(),e&&(e<Fe.items.length-1?fe(Fe.items[e++]).catch(ie):fe(Fe.items[0]).catch(ie));break;case R.REPEAT_SINGLE:Me.seek(0),Me.play(!0);break;case R.REPEAT_ALL_AND_SHUFFLE:if(e=ke())if(e<Fe.items.length-1)fe(Fe.items[e++]).catch(ie);else{for(t=Fe.items.length;t;)i=Math.floor(Math.random()*t--),n=Fe.items[t],Fe.items[t]=Fe.items[i],Fe.items[i]=n;fe(Fe.items[0]).catch(ie)}}}function Ee(e,t){if(Fe){let i;switch(e){case"buffer":i=P.BUFFERING;break;case"idle":i=P.IDLE;break;case"pause":i=P.PAUSED;break;case"play":i=P.PLAYING}let a=Fe.playerState;Fe.playerState=i,t||n.publish(p,{oldState:a,newState:Fe.playerState}),Ae()}}function pe(){if(Me.on("buffer",()=>{Ee("buffer",!1)}),Me.on("idle",()=>{Ee("idle",!1)}),Me.on("pause",()=>{Ee("pause",!1)}),Me.on("play",()=>{Ee("play",!1)}),Me.on("time",se),Me.on("error",ae),Me.on("mediaError",ae),Me.on("complete",ne),Me.on("captionsList",re),Me.on("audioTracks",oe),Me.on("playlistItem",e=>{n.publish(T,{media:Fe.media,playlistItem:e})}),Me.on("seek",e=>n.publish(A,e)),Me.on("seeked",()=>{n.publish(h,{})}),Fe.media.customData&&Fe.media.customData.advertising){let e=Fe.media.customData.advertising;"vast"===e.client?Me.on("adMeta",ue):"googima"===e.client&&Me.on("adImpression",ce)}Me.on("adPlay",e=>{Ee("play",!0),n.publish(k,e)}),Me.on("adPause",e=>{Ee("pause",!0),n.publish(L,e)}),Me.on("adComplete",me),Me.on("adError",e=>{console.error("AdError: %O",e),n.publish(C,e),delete Fe.customData.adMeta,delete Fe.breakStatus,Ae()}),Me.on("adTime",de)}function Ie(){Me.off("buffer"),Me.off("idle"),Me.off("pause"),Me.off("play"),Me.off("time"),Me.off("error"),Me.off("mediaError"),Me.off("complete"),Me.off("captionsList"),Me.off("audioTracks"),Me.off("adMeta"),Me.off("adComplete"),Me.off("adError"),Me.off("adImpression")}function Te(e){we();let t;Fe&&(t=Object.assign({},Fe),t.activeTrackIds||delete t.activeTrackIds);let n={type:M.MEDIA_STATUS,requestId:e?e:Be,status:t?[t]:[]};return Be=0,n}function Ae(e){Ve||a(Te(e))}function he(e,t){if(!Ve){let n=Te(t);s(e,n)}}function ge(e,t){De(M.INVALID_REQUEST,t,e)}function Se(e){a({requestId:e.requestId?e.requestId:0,type:M.INVALID_PLAYER_STATE})}function _e(e){a({requestId:e.requestId?e.requestId:0,type:M.LOAD_CANCELLED})}function De(e,t,n){a({requestId:n.requestId?n.requestId:0,type:e,reason:t})}function Ne(){Me&&(Me.stop(),Ie());let e=Fe?Fe.mediaSessionId+=1:1;Fe=new cast.receiver.media.MediaStatus,Fe.activeTrackIds=[],Fe.supportedMediaCommands=K,Fe.mediaSessionId=e,Fe.customData={}}function ke(){return Le(Fe.currentItemId)}function Le(e){let t=-1;return e&&Fe.items&&0!=Fe.items.length?(Fe.items.some((n,i)=>{if(e==n.itemId)return t=i,!0}),t):t}function ye(e){let t=-1;return e&&Fe.media.tracks&&0!=Fe.media.tracks.length?(Fe.media.tracks.some((n,i)=>{return e==n.trackId&&(t=i,!0)}),t):t}function be(e){let t=ye(e);return t<0?null:Fe.media.tracks[t]}function Ce(e){let t={file:e.contentId,tracks:[]};if(e.customData){let n=e.customData;n.mediaid&&(t.mediaid=n.mediaid),n.advertising&&n.advertising.schedule&&(t.adschedule=n.advertising.schedule),n.drm&&(t.drm=n.drm)}return e.tracks&&e.tracks.forEach(function(e){if(e.type===V.TEXT&&e.trackContentId){let n={file:e.trackContentId,label:e.name};if(e.subtype&&e.subtype!=j.SUBTITLES&&e.subtype!=j.CAPTIONS){if(e.subtype!=j.CHAPTERS)return;n.kind="chapters"}else n.kind="captions";t.tracks.push(n)}}),[t]}function Oe(e,t){return"%"===e.toString().slice(-1)?t*Number.parseFloat(e.slice(0,-1))/100:Number.parseFloat(e)}function Ue(e){let t=[];if(!e.customData||!e.customData.advertising||!e.customData.advertising.schedule)return t;let n=e.customData.advertising.schedule;return Object.keys(n).forEach(i=>{let a,s=n[i];a="pre"==s.offset?0:"post"==s.offset?e.duration:s.offset.indexOf(":")!=-1?jwplayer.utils.seconds(s.offset):Oe(s.offset,e.duration),t.push(new G(i,a))}),t}function Pe(e){let t=Ue(e);t.length>0?e.breaks=t:delete e.breaks,delete e.breakClips}function Re(){let e=1;return Fe.media.tracks.forEach(t=>{t.trackId>=e&&(e=t.trackId++)}),e}function we(){if(!Fe)return!1;let e=[];if(!Me)return Fe.activeTrackIds=e,!1;let t=Me.getCurrentCaptions();if(t>0){let n=Me.getCaptionsList()[t];Fe.media.tracks.some(t=>{if(t.type==V.TEXT&&t.trackContentId==n.id)return e.push(t.trackId),!0})}let n=Me.getCurrentAudioTrack();n>=0&&Fe.media.tracks.some(t=>{if(t.type==V.AUDIO&&t.trackContentId==n)return e.push(t.trackId),!0});let i=Fe.activeTrackIds.length!=e.length||Fe.activeTrackIds.some(t=>e.indexOf(t)<0);return Fe.activeTrackIds=e,i}function ve(){let e=-1;switch(Fe.repeatMode){case R.REPEAT_OFF:return Fe.items.length>=2?Fe.items[1]:null;case R.REPEAT_ALL:return e=ke(),e!=-1?e==Fe.items.length-1?Fe.items[0]:Fe.items[e++]:null;case R.REPEAT_SINGLE:return Fe.items[ke()];case R.REPEAT_ALL_AND_SHUFFLE:if(e=ke(),e!=-1)return e==Fe.items.length-1?null:Fe.items[e++]}return null}let Me,Fe,xe=e.getCastMessageBus(cast.receiver.media.MEDIA_NAMESPACE),Be=0,Ve=!1,je=0;return xe.addEventListener("message",r),{getNextItemInQueue:ve,getRepeatMode:function(){return Fe.repeatMode},addItemToQueue:function(e){z({data:{items:[e]}})}}}function n(e){let t,n=jwplayer.utils,i=e[z[0]],a=e[z[1]],s=e[z[2]],r=e[z[3]];return{update:function(e,o){if(0==e&&0==o)i.innerText="--:--",a.innerText="--:--",s.style.width="0%",t=0;else if("LIVE"===n.streamType(o)){let e=t!=o;e&&(t=o,i.innerText="Live broadcast",a.innerText="",r.style.display="none")}else{i.innerText=n.timeFormat(e);let r=t!=o;r&&(t=o,a.innerText=n.timeFormat(t));let c=e/o*100;s.style.width=c+"%"}},updateAdProgress:function(e,t,s){i.innerText=n.timeFormat(e),a.innerText=`Ad ${t} of ${s}`}}}function i(e,t){let n={};return t instanceof Array||(t=t.split(" ")),t.forEach(t=>{n[t]=e.getElementsByClassName(t)[0]}),n}function a(e){let t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML}function s(e,t){let s=t[J[0]],r=t[J[1]],o=t[J[2]],c=t[J[3]],u=t[J[4]],d=new n(i(e,z));return d.update(0,0),{updateContentProgress:function(e,t){d.update(e,t),this.displayingNextUp&&(c.innerHTML=`video will play in <strong>${Math.round(t-e)} seconds</strong>`)},updateMediaMeta:function(e,t){this.displayingNextUp=t,t?s.innerHTML=`<strong>Next Up:</strong> ${e.title?a(e.title):"Unknown"}`:s.textContent=e.title?e.title:"",r.textContent=e.subtitle?e.subtitle:"",e.images&&e.images.length>0?o.src=e.images[0].url:o.style.display="none",""===s.textContent&&""===r.textContent&&"none"===o.style.display&&(u.style.display="none")},updateAdProgress:d.updateAdProgress}}function r(e){const t="string"==typeof e.logoUrl&&e.logoUrl.length>0;"string"==typeof e.theme&&e.theme.length>0&&(document.body.className=`theme-${a(e.theme)}`),Array.from(document.getElementsByClassName("logo")).forEach(n=>{t?n.style.backgroundImage=`url(${e.logoUrl})`:n.style.display="none"}),"string"==typeof e.siteName&&e.siteName.length>0&&(document.title=e.siteName)}function o(e,t,n,a){function o(t){S=t,e.className=`${t} ${G.join(" ")}`}function c(t){G.indexOf(t)<0&&(F.addClass(e,t),G.push(t))}function u(t){let n=G.indexOf(t);n>=0&&(F.removeClass(e,t),G.splice(n,1))}function d(){clearTimeout(Q),u($.USER_INACTIVE),Q=setTimeout(()=>{c($.USER_INACTIVE)},ee)}function m(e,t){return M!=R.REPEAT_ALL_AND_SHUFFLE&&(n.autoAdvance&&n.autoAdvanceWarningOffset&&"number"==typeof n.autoAdvanceWarningOffset&&t-w<=n.autoAdvanceWarningOffset)}function f(e){switch(e){case P.PAUSED:V.className="jw-icon-pause",l(),o(Z.CONTENT_STATE_PAUSED);break;case P.BUFFERING:w>0&&setTimeout(()=>{T!=P.BUFFERING||q||o(Z.CONTENT_STATE_BUFFERING)},2e3);break;case P.IDLE:V.className="jw-icon-pause",o(Z.APP_STATE_IDLE);break;case P.PLAYING:V.className="jw-icon-play",o(Z.CONTENT_STATE_PLAYING)}}function l(){j.updateMediaMeta(v.media.metadata,!1)}let T,S,w,v,M,F=jwplayer.utils,x=e.getElementsByClassName("overlay")[0],B=e.getElementsByClassName("jw-error-message")[0],V=document.getElementById("jw-icon-state"),j=new s(x,i(x,J)),G=[],Q=-1,q=!1,Y=1,H=1,K=-1;r(n),o(Z.APP_STATE_LOADING),t.subscribe(E,()=>o(Z.APP_STATE_IDLE)),t.subscribe(I,e=>{B.textContent="",window.clearTimeout(K),u($.RECOVERABLE_ERROR),o(Z.CONTENT_STATE_LOADING),v=e.item,j.updateContentProgress(0,0),l()}),t.subscribe(p,e=>{T=e.newState,T==P.IDLE?o(Z.APP_STATE_IDLE):(S!=Z.CONTENT_STATE_NEXTUP||T!=P.PLAYING&&S==Z.CONTENT_STATE_NEXTUP)&&f(T)}),t.subscribe(g,e=>{e.currentTime<w&&(d(),j.displayingNextUp&&(l(),f(T))),w=e.currentTime,j.updateContentProgress(e.currentTime,e.duration);let t=m(w,e.duration);if(!j.displayingNextUp&&t){let e=a.getNextItemInQueue();e&&j.updateMediaMeta(e.media.metadata,!0)}t&&S!=Z.CONTENT_STATE_NEXTUP&&o(Z.CONTENT_STATE_NEXTUP)}),t.subscribe(O,d),t.subscribe(_,e=>{return M=e.queueRepeatMode}),t.subscribe(D,()=>{if(j.displayingNextUp){let e=a.getNextItemInQueue();j.updateMediaMeta(e.media.metadata,!0)}}),t.subscribe(A,()=>c($.SEEK)),t.subscribe(h,()=>u($.SEEK)),t.subscribe(N,e=>{q=!0;let t=e.meta;Y=t.sequence?t.sequence:1,H=t.podcount?t.podcount:1,o(Z.AD_PLAYBACK)}),t.subscribe(k,()=>{V.className="jw-icon-play"}),t.subscribe(L,()=>{V.className="jw-icon-pause"}),t.subscribe(y,e=>{j.updateAdProgress(Math.round(e.duration-e.position),Y,H)}),t.subscribe(b,()=>{q=!1,j.updateContentProgress(0,0),f(P.BUFFERING)}),t.subscribe(C,()=>{q=!1}),t.subscribe(U,e=>{if(B.textContent=e.error.message,e.willAdvance&&e.nextItem){c($.RECOVERABLE_ERROR),j.updateMediaMeta(e.nextItem.media.metadata,!0);const t=5;let n=Date.now(),i=function(){let e=(Date.now()-n)/1e3;j.updateContentProgress(e,t),e<5&&(K=window.setTimeout(i,1e3))};i()}else K=window.setTimeout(()=>{o(Z.APP_STATE_IDLE)},5e3);o(Z.APP_STATE_ERROR)})}function c(e,t,n){function i(t){!r&&n.getRepeatMode()==R.REPEAT_OFF&&s&&t.duration-t.currentTime<=c&&!n.getNextItemInQueue()&&(r=!0,ae.load(e.recommendationsPlaylist,s).then(e=>{let t=a(e.playlist);t&&(o.push(t.media.customData.mediaid),n.addItemToQueue(t))},e=>{console.warn("Error loading recommendations: %O",e)}))}function a(e){let t=null;if(!e)return null;let n=!e.some(e=>o.indexOf(e.mediaid)==-1);return n&&(o=[]),e.some(e=>{let n=new cast.receiver.media.MediaInformation;if(o.indexOf(e.mediaid)==-1&&e.sources){let i;if(e.sources.some(e=>{if("application/vnd.apple.mpegurl"==e.type)return void(i=e)}),i||e.sources.forEach(e=>{cast.receiver.platform.canDisplayType(e.type)&&(i?e.width>i.width&&(i=e):i=e)}),i)return n.contentId=i.file,e.tracks&&e.tracks.forEach((e,t)=>{if("captions"===e.kind){let i=new cast.receiver.media.Track(t,V.TEXT);i.name=e.label,i.subtype=j.CAPTIONS,i.trackContentId=e.file,n.tracks=n.tracks||[],n.tracks.push(i)}}),n.streamType=cast.receiver.media.StreamType.NONE,n.duration=e.duration,n.customData={mediaid:e.mediaid},n.metadata={metadataType:0,images:e.image?[{url:e.image,width:0,height:0}]:[],title:e.title,subtitle:e.description},t={media:n},!0}}),t}let s,r=!1,o=[],c=0;"number"==typeof e.autoAdvanceWarningOffset&&(c=e.autoAdvanceWarningOffset+5),c&&(t.subscribe(g,i),t.subscribe(T,e=>{r=!1;let t=e.media;t.customData&&t.customData.mediaid&&(s=t.customData.mediaidz)}))}function u(e,t){function n(){window.clearTimeout(s),s=window.setTimeout(i,oe)}function i(){a!=P.BUFFERING&&a!=P.PLAYING&&t.stop()}let a,s=-1;e.subscribe(O,n),e.subscribe(p,e=>{a=e.newState,n()}),n()}function d(n,i){let a,s=new e,r=cast.receiver.CastReceiverManager.getInstance();r.onReady=(e=>{s.publish(E,e),a=new u(s,r)}),r.onSenderDisconnected=function(e){0===r.getSenders().length&&e.reason===cast.receiver.system.DisconnectReason.REQUESTED_BY_SENDER&&r.stop()};let d=new t(r,document.getElementById("player"),s,new re(i));new o(n,s,i,d);if("string"==typeof i.recommendationsPlaylist){new c(i,s,d)}r.start()}function m(){!de&&me&&"loading"!=document.readyState&&(console.info("Initializing the JWCastApp with config %O",me),de=new d(document.getElementById("app"),me))}function f(e){let t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");let n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function l(){cast.receiver.CastReceiverManager.getInstance().stop()}const E="ready",p="stateChange",I="mediaLoad",T="mediaLoaded",A="mediaSeek",h="mediaSeeked",g="mediaTime",S="mediaComplete",_="queueLoad",D="queueUpdate",N="adImpression",k="adPlay",L="adPause",y="adTime",b="adComplete",C="adError",O="userActivity",U="mediaError",P={BUFFERING:"BUFFERING",IDLE:"IDLE",PAUSED:"PAUSED",PLAYING:"PLAYING"},R={REPEAT_OFF:"REPEAT_OFF",REPEAT_ALL:"REPEAT_ALL",REPEAT_SINGLE:"REPEAT_SINGLE",REPEAT_ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"},w={ALL_BASIC_MEDIA:15,PAUSE:1,QUEUE_NEXT:64,QUEUE_PREV:128,QUEUE_SHUFFLE:256,SEEK:2,STREAM_MUTE:8,STREAM_VOLUME:4},v={LOAD:"LOAD",STOP:"STOP",PAUSE:"PAUSE",PLAY:"PLAY",SEEK:"SEEK",SET_VOLUME:"SET_VOLUME",GET_STATUS:"GET_STATUS",EDIT_TRACKS_INFO:"EDIT_TRACKS_INFO",QUEUE_LOAD:"QUEUE_LOAD",QUEUE_UPDATE:"QUEUE_UPDATE",QUEUE_INSERT:"QUEUE_INSERT",QUEUE_REMOVE:"QUEUE_REMOVE",QUEUE_REORDER:"QUEUE_REORDER",PRELOAD:"PRELOAD",CANCEL_PRELOAD:"CANCEL_PRELOAD"},M={INVALID_PLAYER_STATE:"INVALID_PLAYER_STATE",LOAD_FAILED:"LOAD_FAILED",LOAD_CANCELLED:"LOAD_CANCELLED",INVALID_REQUEST:"INVALID_REQUEST",MEDIA_STATUS:"MEDIA_STATUS"},F={INVALID_COMMAND:"INVALID_COMMAND",INVALID_PARAMS:"INVALID_PARAMS",INVALID_MEDIA_SESSION_ID:"INVALID_MEDIA_SESSION_ID",DUPLICATE_REQUEST_ID:"DUPLICATE_REQUEST_ID"},x={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"},B={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"},V={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"},j={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};class G{constructor(e,t){if("string"!=typeof e||"number"!=typeof t)throw new Error("Invalid arguments supplied");this.id=e,this.position=t,this.isWatched=!1,this.duration=0,this.breakClipIds=null}}class Q{constructor(e){if("string"!=typeof e)throw new Error("Invalid arguments supplied.");this.id=e,this.duration=0,this.clickThroughUrl=null,this.contentUrl=null,this.mimeType=null,this.title=null,this.customData=null}}class q{constructor(e,t){this.currentBreakTime=e,this.currentBreakClipTime=t,this.breakId=null,this.breakClipId=null,this.whenSkippable=-1}}class Y{constructor(e){this.id=e,this.linear="linear",this.tag=null,this.client=null,this.witem=1,this.wcount=1,this.sequence=1,this.podcount=1,this.creativetype=null,this.skipoffset=null,this.skipMessage=null,this.skipText=null,this.message=null,this.clickthrough=null,this.title=null,this.companions=null}}class H{constructor(e,t,n,i,a,s){this.width=e?e:0,this.height=t?t:0,this.type=n,this.source=i,this.trackers=a?a:{},this.clickthrough=s}static convertImaCompanions(){let e=[];return e.forEach(t=>{e.push(new H(t.getWidth(),t.getHeight(),"html",t.getContent(),null,null))}),e}}const K=w.ALL_BASIC_MEDIA+w.QUEUE_NEXT+w.QUEUE_PREV+w.QUEUE_SHUFFLE,X=0,W=5e3,z=["jw-text-elapsed","jw-text-duration","jw-progress-bar","jw-timeslider"],J=["jw-media-title","jw-media-description","jw-thumb-container","jw-nextup-timer","media-metadata"],$={SEEK:"flag-seek",USER_INACTIVE:"flag-user-inactive",RECOVERABLE_ERROR:"flag-recoverable-error"},Z={APP_STATE_LOADING:"app-state-loading",APP_STATE_IDLE:"app-state-idle",CONTENT_STATE_LOADING:"content-state-loading",CONTENT_STATE_PLAYING:"content-state-playback",CONTENT_STATE_BUFFERING:"content-state-buffering",CONTENT_STATE_PAUSED:"content-state-paused",CONTENT_STATE_NEXTUP:"content-state-nextup",APP_STATE_ERROR:"app-state-error",AD_PLAYBACK:"ad-playback"},ee=5e3,te=5e3;class ne{static ajax(e,t,n,i){return new Promise((a,s)=>{var r=new XMLHttpRequest;if(i)for(let o in i)i.hasOwnProperty(o)&&(r[o]=i[o]);if(r.onload=function(){this.status>=200&&this.status<300?a(this.response):s(this.statusText)},r.onerror=function(){s(this.statusText)},r.open(e,t,!0),n)for(let c in n)n.hasOwnProperty(c)&&r.setRequestHeader(c,n[c]);r.timeout=te,r.send()})}static get(e,t,n){return n||(n={responseType:"json"}),this.ajax("GET",e,t,n)}}const ie="https://content.jwplatform.com/feed.json";class ae{static load(e,t){return new Promise((n,i)=>{ne.get(`${ie}?feed_id=${e}&related_media_id=${t}`).then(t=>{t.kind&&"FEED"==t.kind||i(`Error: Feed ${e} is not a related feed!`),n(t)},i)})}}const se=5;class re{constructor(e){this.iossdkversion=ce,this.applicationname="string"==typeof e.siteName?e.siteName:"",this.sdkplatform=se}}const oe=12e5,ce="1.0.0";class ue{static getConfig(e){const t=`./${e}/config.json`,n=`https://${e}.jwpapp.com/config.json`;return new Promise((e,i)=>{ue.requestConfig(t,e,function(){ue.requestConfig(n,e,i)})})}static requestConfig(e,t,n){ne.get(e).then(i=>{this.validateConfig(i)?t(i):n("Invalid configuration: "+e)}).catch(function(){n("Invalid configuration: "+e)})}static validateConfig(e){let t=!0;return e.key||(t=!1),"number"!=typeof e.autoAdvanceWarningOffset&&(e.autoAdvanceWarningOffset=10),t}}window.DEBUG=jwplayer.version.search(/[0-9]+\.[0-9]+\.[0-9].*\+local\./)!=-1,DEBUG&&cast.receiver.logger.setLevelValue(cast.receiver.LoggerLevel.DEBUG);let de,me,fe=f("appName"),le=f("key");fe?ue.getConfig(fe).then(e=>{jwplayer.key=e.key||le,me=e,m()},e=>{console.error(e),l()}):le?(jwplayer.key=le,me={siteName:"Chromecast Player",theme:"dark",logoUrl:"",key:le},m()):(console.error("Error: appName missing."),l()),document.addEventListener("DOMContentLoaded",m)}();
